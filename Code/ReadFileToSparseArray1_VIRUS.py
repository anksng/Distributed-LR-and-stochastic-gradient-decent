
# coding: utf-8

# In[1]:

import os
import numpy as np
import scipy.sparse as sp


# In[2]:
######reading the dataset:
VirusShareExecDSPath = "/home/ankit/Masters/Distributed data lab/EX 4/dataset"


# In[3]:

def read_file_names(path):
    """Method to read return list of paths of all the files in the dataset"""
    file = []
    for root_dir, sub_dirs, files in os.walk(path):
        for name in files:
            file_address = os.path.join(root_dir, name)
            file.append(file_address)
#         print("file all",file)
        return file

# ds_info(VirusShareExecDSPath)


# In[5]:

def read_sparse_files(files):
    """Reads given list of files to a single sparse matrix"""
    
    n = 0
    m = 0
    
    y = []
    rows = []
    
    for path in files:
        with open(path, 'r') as sf:
            lines = sf.readlines()

        for line in lines:
            line = line.strip(' \n')
            words = line.split()

            y.append(float(words[0]))

            row = {}
            for item in words[1:]:
                temp = item.split(':')

                key = int(temp[0])
                row[key] = int(temp[1])

                if m < key:
                    m = key

            rows.append(row)
    
    n = (len(y))
    m += 1
    X = sp.dok_matrix((n, m), dtype=np.int32)
    
    i = 0
    for row in rows:
        for key in row:
            X[i, key] = row[key]
        i += 1
    
    return X.tocsr(), y


# In[6]:

virus_exec_files = read_file_names(VirusShareExecDSPath)


# In[9]:

X, y = read_sparse_files(virus_exec_files)


# In[225]:

import sys
# sys.getsizeof(X[10])

# print(X[0:])


# In[11]:

#print("size of sparse array in bytes",sys.getsizeof(X.toarray()))
#print("size of compressed array in bytes",sys.getsizeof(X))


# In[14]:


import pandas as pd
import numpy as np
from math import sqrt, isnan
import matplotlib.pyplot as plt
import warnings
warnings.filterwarnings('ignore')


# In[25]:

df = pd.DataFrame(X.toarray())
df
df_y = pd.DataFrame(y)

# In[46]:

def splitdata(inputDataframe, frac):
    
        train_data = inputDataframe.sample(frac=frac)
        test_data = inputDataframe.drop(train_data.index)
        train_data=train_data.reset_index(drop=True)
        test_data=test_data.reset_index(drop=True)
        return train_data,test_data


train_x,test_x=splitdata(df,0.7)
train_y, test_y =splitdata(df_y,0.7)


# In[74]:


    
### this function predicts linear regression to calculate y_pred.
    
def predict_LR(X, parameters):
    
    y_pred = np.dot(parameters, X.T)
    return y_pred 
len(df)

## function SGD Epoch and returns weight:
    
def SGD_Epoch(x, y, alpha, beta):
    x = x * 1.0
    y = y * 1.0
    for i in range(0,len(x)):
        
        y_prediction = np.dot(beta, x[i].T)
            
        error = y_prediction - y[i]
        gradient = 2*(error)*beta
        learning_rate =alpha
        
        beta = beta - ((learning_rate * gradient))
        
    return beta

def rmse(y, y_pred):
    n = y.shape[0]
    return sqrt((1.0) * np.sum(np.square((y - y_pred[0].T))))/n


    
    


# In[ ]:
  ### MPI implementation starts here:  
from mpi4py import MPI
comm = MPI.COMM_WORLD
rank = comm.Get_rank()
size = comm.size
from time import time
x_i=train_x    # train X values
y_i=train_y    # target Y train 
x_i = np.array(x_i)
y_i =np.array(y_i)
length =int(len(x_i))
step = int(length//size)
assert len(x_i)==len(y_i)
Rmse =[]
epoch= []

alpha = 0.0000001
max_itr= 100
np.random.seed(10)
time_epoch=[]
beta1 = np.random.randint(1,2,size=((df.shape[1])))     # initial beta
#print("Initial beta1:",beta1)    ## print commands to debug beta
for i in range(max_itr):
#    beta1 = beta1
     beta1 = comm.bcast(beta1,root=0)   ## broadcasting beta to all in each itr.
     data_x = x_i[(rank)*step:(rank+1)*step]     #workers get their chunks based on rank
     data_y = y_i[(rank)*step:(rank+1)*step]
    #print("i am worker",rank,"i received chunk:",data_x)
     weights_collect=[]
     weights = SGD_Epoch(data_x, data_y, alpha, beta1)   #SGD Epoch returns weight
     weights_collect.append(weights)   
#    print("weights gathered for me",rank,weights_collect)
     weight = comm.gather(weights_collect,root=0 )   #gather weight at root
     #print("rank:",rank,weights_collect)
     if rank ==0:
         beta = np.mean(weight,axis = 0)  #calculating mean at root
#        print("updated weights :",i,beta)
         RMSE = rmse(test_y, predict_LR(test_x, beta[0]))
         Rmse.append(RMSE)
         epoch.append(i)
         t1 = time()
         time_epoch.append(t1)
         beta1 = beta[0]     #assign updated beta to bcast variable.
#
print("Loss:",i,Rmse)
print("Time taken for",i,"epochs",time_epoch)  

#### storing RMSE values to plot #####
rmse_p1=[3.024584055256843, 2.9996330113356984, 2.975089077398153, 2.950942370240429, 2.9271833239971365, 2.903802677506139, 2.8807914622719437, 2.858140990995596, 2.8358428466395673, 2.813888871999269, 2.792271159753245, 2.7709820429676837, 2.7500140860302573, 2.729360075991453, 2.7090130142916706, 2.688966108854669, 2.6692127665283545, 2.6497465858551257, 2.630561350155249, 2.611651020907647, 2.5930097314132055, 2.574631780726586, 2.5565116278433213, 2.5386438861301017, 2.5210233179857084, 2.5036448297227643, 2.486503466658121, 2.4695944084034926, 2.452912964346107, 2.436454569310476, 2.4202147793931688, 2.4041892679625962, 2.3883738218157258, 2.3727643374852967, 2.357356817690326, 2.342147367923231, 2.3271321931681364, 2.3123075947437672, 2.2976699672661094, 2.2832157957249635, 2.268941652670121, 2.25484419550155, 2.2409201638600798, 2.227166377113389, 2.213579731933915, 2.200157199964385, 2.1868958255675373, 2.1737927236563075, 2.1608450776013486, 2.148050137212518, 2.1354052167913453, 2.1229076932517157, 2.1105550043057884, 2.0983446467126123, 2.0862741745870546, 2.0743411977664135, 2.0625433802324777, 2.0508784385871275, 2.0393441405789297, 2.0279383036790835, 2.0166587937045692, 2.005503523486925, 1.9944704515847165, 1.9835575810380666, 1.9727629581637238, 1.9620846713890172, 1.9515208501233612, 1.9410696636658662, 1.930729320147672, 1.920498065507728, 1.9103741825009064, 1.9003559897371505, 1.8904418407505028, 1.8806301230969706, 1.8709192574804485, 1.861307696905114, 1.8517939258539118, 1.8423764594919638, 1.8330538428938532, 1.823824650294602, 1.814687484362498, 1.8056409754938803, 1.7966837811288618, 1.7878145850869378, 1.7790320969223778, 1.7703350512983314, 1.7617222073789098, 1.7531923482392446, 1.7447442802921547, 1.7363768327314455, 1.728088856990849, 1.7198792262186078, 1.7117468347666829, 1.703690597694243, 1.69570945028534, 1.6878023475796582, 1.6799682639165416, 1.6722061924913687, 1.6645151449243425, 1.6568941508408483, 1.6493422574632823, 1.641858529214043, 1.6344420473291752, 1.6270919094822403, 1.619807229418416, 1.6125871365983093, 1.6054307758510389, 1.5983373070366695, 1.5913059047173734, 1.584335757837227, 1.5774260694104, 1.5705760562173368, 1.5637849485087179, 1.557051989717266, 1.550376436176666, 1.543757556847789, 1.5371946330517336, 1.5306869582098572, 1.5242338375900717, 1.5178345880595767, 1.5114885378438738, 1.505195026291616, 1.4989534036454122, 1.4927630308180633, 1.486623279174561, 1.4805335303192777, 1.4744931758881925, 1.46850161734647, 1.4625582657906433, 1.456662541755644, 1.4508138750265527, 1.4450117044547606, 1.4392554777783666, 1.4335446514470547, 1.4278786904510234, 1.4222570681537612, 1.4166792661290295, 1.4111447740014045, 1.405653089290581, 1.4002037172593702, 1.3947961707650667, 1.389429970114301, 1.3841046429211834, 1.378819723968684, 1.3735747550731667, 1.3683692849519296, 1.3632028690938145, 1.3580750696326835, 1.352985455223629, 1.3479336009221272, 1.3429190880657247, 1.3379415041582827, 1.3330004427570206, 1.3280955033618138, 1.32322629130693, 1.3183924176552748, 1.3135934990946938, 1.3088291578368474, 1.3040990215177977, 1.2994027231013003, 1.2947399007836078, 1.2901101979006744, 1.285513262837237, 1.2809487489377085, 1.2764163144191119, 1.2719156222856924, 1.2674463402455072, 1.2630081406285318, 1.2586007003066249, 1.254223700615089, 1.249876827275923, 1.245559770322505, 1.2412722240260017, 1.2370138868231275, 1.23278446124548, 1.2285836538502668, 1.2244111751523743, 1.2202667395580022, 1.2161500652993826, 1.2120608743709522, 1.207998892466776, 1.2039638489192654, 1.199955476638902, 1.1959735120554909, 1.192017695060275, 1.1880877689492775, 1.1841834803678866, 1.1803045792562936, 1.1764508187961873, 1.1726219553583066, 1.1688177484511981, 1.1650379606708443, 1.1612823576511775, 1.1575507080158005, 1.15384278333034, 1.1501583580558605, 1.1464972095032033, 1.1428591177880072, 1.1392438657867656, 1.1356512390936293, 1.1320810259779952, 1.1285330173428771, 1.1250070066841698, 1.121502790050516, 1.1180201660040197, 1.114558935581607, 1.1111189022571668, 1.1076998719043556, 1.1043016527600718, 1.1009240553885538, 1.0975668926462816, 1.0942299796473338, 1.0909131337294604, 1.087616174420762, 1.0843389234069898, 1.0810812044992857, 1.0778428436027576, 1.0746236686853472, 1.071423509747424, 1.0682421987918562, 1.0650795697946012, 1.0619354586757914, 1.0588097032714443, 1.0557021433054852, 1.052612620362405, 1.049540977860354, 1.0464870610246308, 1.043450716861765, 1.0404317941338759, 1.0374301433336166, 1.034445616659503, 1.031478067991643, 1.0285273528678442, 1.0255933284602383, 1.0226758535522082, 1.019774788515732, 1.016889995289047, 1.014021337354906, 1.0111686797188653, 1.008331888888187, 1.0055108328510896, 1.0027053810560589, 0.9999154043919656, 0.9971407751680856, 0.9943813670946877, 0.9916370552638173, 0.9889077161305435, 0.9861932274943112, 0.9834934684807557, 0.9808083195238081, 0.9781376623479371, 0.9754813799508582, 0.9728393565864689, 0.9702114777479309, 0.9675976301512537, 0.9649977017188875, 0.9624115815637981, 0.9598391599737164, 0.9572803283955265, 0.9547349794200798, 0.9522030067671055, 0.9496843052704861, 0.9471787708636565, 0.9446863005652716, 0.9422067924650495, 0.9397401457100141, 0.9372862604906731, 0.9348450380276575, 0.9324163805584285, 0.9300001913242146, 0.927596374557183, 0.9252048354677896, 0.9228254802322822, 0.9204582159804899, 0.9181029507836835, 0.9157595936427331, 0.9134280544763107, 0.911108244109418, 0.9088000742620089, 0.9065034575377042, 0.9042183074129335, 0.9019445382258539, 0.8996820651658644, 0.8974308042628734, 0.8951906723770278, 0.8929615871884201, 0.8907434671870441, 0.8885362316628472, 0.8863398006959, 0.8841540951468037, 0.881979036647209, 0.8798145475903411, 0.8776605511218728, 0.8755169711307642, 0.8733837322403638, 0.8712607597994982, 0.8691479798738221, 0.8670453192371942, 0.8649527053632584, 0.862870066417044, 0.8607973312468239, 0.8587344293759739, 0.8566812909949457, 0.8546378469534653, 0.8526040287526997, 0.8505797685376869, 0.848564999089689, 0.8465596538188201, 0.8445636667566828, 0.8425769725491876, 0.8405995064493255, 0.8386312043102051, 0.8366720025780875, 0.8347218382855677, 0.832780649044801, 0.8308483730408721, 0.8289249490252304, 0.8270103163092013, 0.8251044147576304, 0.8232071847825599, 0.8213185673370216, 0.8194385039089445, 0.8175669365150781, 0.8157038076950407, 0.8138490605054417, 0.8120026385140834, 0.8101644857942312, 0.8083345469189733, 0.806512766955617, 0.8046990914602571, 0.802893466472272, 0.8010958385090736, 0.7993061545607034, 0.7975243620847376, 0.795750409001072, 0.7939842436868801, 0.7922258149715716, 0.7904750721318837, 0.7887319648870301, 0.7869964433937838, 0.785268458241849, 0.783547960449107, 0.7818349014569781, 0.780129233125898, 0.7784309077307567, 0.7767398779564972, 0.7750560968936905, 0.773379518034201, 0.7717100952669119, 0.7700477828735018, 0.7683925355242343, 0.7667443082739407, 0.7651030565577736, 0.7634687361873851, 0.7618413033468355, 0.7602207145887262, 0.7586069268302899, 0.7569998973496463, 0.7553995837819412, 0.753805944115734, 0.752218936689208, 0.7506385201866145, 0.7490646536346584, 0.7474972963989454, 0.7459364081805581, 0.7443819490124729, 0.7428338792562814, 0.7412921595987289, 0.7397567510484315, 0.7382276149325822, 0.7367047128936961, 0.7351880068864007, 0.7336774591742797, 0.732173032326721, 0.7306746892158701, 0.7291823930135216, 0.727696107188135, 0.726215795501847, 0.724741422007518, 0.7232729510458429, 0.7218103472424464, 0.7203535755050555, 0.7189026010207357, 0.7174573892530195, 0.7160179059392607, 0.7145841170878927, 0.7131559889757326, 0.7117334881453665, 0.7103165814025231, 0.7089052358134997, 0.7074994187025916, 0.7060990976496032, 0.704704240487322, 0.703314815299087, 0.701930790416301, 0.7005521344161085, 0.6991788161189435, 0.6978108045862017, 0.69644806911793, 0.6950905792505166]
rmse_p2 = [3.0369655840635494, 3.030528239277076, 3.027336341055875, 3.0257536467947745, 3.024968866913098, 3.024579732084401, 3.02438677841426, 3.0242911016828296, 3.0242436600323965, 3.0242201359153014, 3.0242084713940676, 3.024202687497411, 3.024199819530443, 3.0241983974382007, 3.0241976922884124, 3.024197342637223, 3.0241971692613543, 3.0241970832922758, 3.024197040664155, 3.024197019526873, 3.024197009045864, 3.024197003848819, 3.024197001271823, 3.0241969999940426, 3.024196999360441, 3.024196999046251, 3.0241969988904582, 3.024196998813229, 3.024196998774927, 3.0241969987559276, 3.024196998746499, 3.0241969987418598, 3.0241969987395225, 3.0241969987383834, 3.0241969987378066, 3.0241969987375166, 3.0241969987374016, 3.024196998737324, 3.0241969987372923, 3.0241969987372768, 3.024196998737271, 3.024196998737265, 3.0241969987372648, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643, 3.0241969987372643]
rmse_p4 =[3.043539958851391, 3.041965470438395, 3.0415735081745705, 3.041475930685924, 3.0414516391395683, 3.0414455918505574, 3.0414440864006664, 3.0414437116245807, 3.041443618325477, 3.041443595099029, 3.041443589316873, 3.0414435878774335, 3.041443587519095, 3.041443587429891, 3.041443587407677, 3.0414435874021546, 3.0414435874007704, 3.0414435874004213, 3.041443587400364, 3.0414435874003383, 3.0414435874003316, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331, 3.041443587400331]
rmse_p6 = [3.0457157268011494, 3.045012175988151, 3.0448952481691913, 3.044875815144936, 3.0448725854390792, 3.0448720486724543, 3.0448719594635305, 3.044871944637292, 3.0448719421732386, 3.0448719417637298, 3.0448719416956616, 3.0448719416843213, 3.0448719416824597, 3.0448719416821577, 3.044871941682101, 3.0448719416820866, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857, 3.0448719416820857]
rmse_p7 = [3.0462476991273695, 3.045727368972347, 3.0456532221455213, 3.04564265625153, 3.0456411506157135, 3.0456409360631693, 3.0456409054895195, 3.0456409011327703, 3.045640900511966, 3.045640900423454, 3.04564090041085, 3.045640900409046, 3.0456409004088374, 3.0456409004088094, 3.045640900408803, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005, 3.0456409004088005]

rmse_p8=[3.0467595519548287, 3.046363148817747, 3.0463137171287205, 3.0463075529689165, 3.046306784294619, 3.046306688440485, 3.04630667648741, 3.0463066749968575, 3.0463066748109986, 3.0463066747878136, 3.046306674784919, 3.046306674784584, 3.0463066747845264, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167, 3.0463066747845167]

import matplotlib.pyplot as plt
#plt.plot(epoch[:10],rmse_p1[:10],'g',label= "P=1")
#plt.plot(epoch[:10],rmse_p2[:10],'r',label= "P=2")
#plt.plot(epoch[:10],rmse_p4[:10],'y',label= "P=4")
#plt.plot(epoch[:10],rmse_p6[:10],'c',label= "P=6")
#plt.plot(epoch[:10],rmse_p7[:10],'m',label= "P=7")
#plt.plot(epoch[:10],rmse_p8[:10],'k',label= "P=8")
plt.plot(epoch,Rmse,'g', label='P=4')

plt.xlabel('epoch')
plt.ylabel('RMSE')
plt.title("RMSE vs epochs P=1,2,4,6,7,8")
plt.legend()
plt.show()





































